# Zephyr to qTest Entity Mapping

This document details the mapping of entities between Zephyr Scale and qTest, including field transformations, custom field handling, and special considerations.

## Core Entity Mappings

### 1. Projects

| Zephyr Scale | qTest | Notes |
|--------------|-------|-------|
| `id` | N/A | qTest project must be created beforehand |
| `key` | N/A | Used for reference only |
| `name` | `name` | Direct mapping |
| `description` | `description` | Direct mapping |

### 2. Folders/Modules

| Zephyr Scale | qTest | Notes |
|--------------|-------|-------|
| `id` | N/A | Generated by qTest |
| `name` | `name` | Direct mapping |
| `folderType` | N/A | qTest uses a different organization model |
| `parentId` | `parentId` | Hierarchical structure preserved |
| N/A | `pid` | Generated by qTest |

### 3. Test Cases

| Zephyr Scale | qTest | Notes |
|--------------|-------|-------|
| `id` | N/A | Generated by qTest |
| `key` | N/A | Stored in custom field for reference |
| `name` | `name` | Direct mapping |
| `objective` | `description` | Maps to description in qTest |
| `precondition` | `precondition` | Direct mapping |
| `estimatedTime` | Custom field | Mapped to custom field in qTest |
| `priority` | `priorityId` | Mapped to qTest priority system |
| `status` | Custom field | Mapped to custom field in qTest |
| `labels` | Custom field | Converted to custom field in qTest |
| `owner` | `creatorId` | Mapped to qTest user |
| `folder` | `moduleId` | Maps to module in qTest |
| `customFields` | `properties` | Custom field mapping (detailed below) |

### 4. Test Steps

| Zephyr Scale | qTest | Notes |
|--------------|-------|-------|
| `id` | N/A | Generated by qTest |
| `description` | `description` | Direct mapping |
| `expectedResult` | `expectedResult` | Direct mapping |
| `testData` | Description + delimiter | Combined with description in qTest |
| `attachments` | `attachments` | Mapped with binary content |

### 5. Test Cycles

| Zephyr Scale | qTest | Notes |
|--------------|-------|-------|
| `id` | N/A | Generated by qTest |
| `key` | N/A | Stored in custom field for reference |
| `name` | `name` | Direct mapping |
| `description` | `description` | Direct mapping |
| `environment` | Custom field | Mapped to custom field in qTest |
| `status` | Custom field | Mapped to custom field in qTest |
| `plannedStartDate` | `startDate` | Direct mapping |
| `plannedEndDate` | `endDate` | Direct mapping |
| `owner` | Custom field | Mapped to custom field in qTest |
| `folderType` | N/A | qTest uses a different organization model |
| `projectId` | `projectId` | Direct mapping |
| `customFields` | `properties` | Custom field mapping (detailed below) |

### 6. Test Executions

| Zephyr Scale | qTest | Notes |
|--------------|-------|-------|
| `id` | N/A | Generated by qTest |
| `testCaseKey` | N/A | Used to link to test case |
| `testCycleKey` | N/A | Used to link to test cycle |
| `status` | `status` | Mapped to qTest status system |
| `executedBy` | `executedBy` | Direct mapping if user exists |
| `executedOn` | `executionDate` | Direct mapping |
| `comment` | `note` | Direct mapping |
| `attachments` | `attachments` | Mapped with binary content |

### 7. Test Step Results

| Zephyr Scale | qTest | Notes |
|--------------|-------|-------|
| `status` | `status` | Mapped to qTest status system |
| `comment` | `actualResult` | Maps to actual result in qTest |
| `attachments` | `attachments` | Mapped with binary content |
| `defects` | Custom field + link | Mapped to custom field and link in qTest |

### 8. Attachments

| Zephyr Scale | qTest | Notes |
|--------------|-------|-------|
| `id` | N/A | Generated by qTest |
| `filename` | `name` | Direct mapping |
| `contentType` | `contentType` | Direct mapping |
| `content` | Binary data | Direct mapping with binary content |
| `fileSize` | `size` | Direct mapping |

## Custom Field Mapping

### Type Conversions

| Zephyr Field Type | qTest Field Type | Conversion Logic |
|-------------------|------------------|------------------|
| `TEXT` | `STRING` | Direct mapping |
| `TEXTAREA` | `STRING` | Direct mapping, may truncate if needed |
| `CHECKBOX` | `CHECKBOX` | Direct mapping |
| `RADIO` | `STRING` | Convert option to string value |
| `DROPDOWN` | `STRING` | Convert option to string value |
| `MULTISELECT` | `STRING` | Join values with delimiter |
| `NUMBER` | `NUMBER` | Direct mapping |
| `DATE` | `DATE` | Format conversion if needed |
| `USER` | `STRING` | Extract username or display name |
| `TABLE` | `STRING` | Format as tabular text with headers and rows |
| `HIERARCHICAL_SELECT` | `STRING` | Extract hierarchy path as delimited text |
| `COMPONENT` | `STRING` | Extract component names |
| `VERSION` | `STRING` | Extract version string |
| `LABEL` | `STRING` | Join multiple labels with delimiter |
| `SPRINT` | `STRING` | Extract sprint name |

### Special Custom Fields

| Zephyr Field | qTest Field | Conversion Logic |
|--------------|-------------|------------------|
| `Epic Link` | `Epic_Link` | Map to corresponding qTest field |
| `Components` | `Components` | Split/join as needed |
| `Labels` | `Tags` | Split/join as needed |
| `Sprint` | `Sprint_Release` | Map to appropriate qTest structure |
| `Automated` | `Automation` | Map boolean to qTest automation status |
| `Test Type` | `Test_Type` | Direct mapping |
| `Severity` | `Severity` | Direct mapping |
| `Risk Level` | `Risk_Level` | Direct mapping |

### Status Mapping

| Zephyr Status | qTest Status | Notes |
|--------------|-------------|-------|
| `PASS` | `PASSED` | |
| `FAIL` | `FAILED` | |
| `WIP` | `IN_PROGRESS` | |
| `BLOCKED` | `BLOCKED` | |
| `NOT EXECUTED` | `NOT_RUN` | |
| `UNEXECUTED` | `NOT_RUN` | |
| `PASS WITH WARNINGS` | `PASSED` | Mapped to same target status |
| `CONDITIONAL PASS` | `PASSED` | Mapped to same target status |
| `IN PROGRESS` | `IN_PROGRESS` | |
| `EXECUTING` | `IN_PROGRESS` | |
| `ABORTED` | `BLOCKED` | |
| `CANCELED` | `NOT_RUN` | |
| `PENDING` | `NOT_RUN` | |

### Priority Mapping

| Zephyr Priority | qTest Priority | Notes |
|--------------|-------------|-------|
| `HIGHEST` | `CRITICAL` | |
| `HIGH` | `HIGH` | |
| `MEDIUM` | `MEDIUM` | |
| `LOW` | `LOW` | |
| `LOWEST` | `TRIVIAL` | |
| `BLOCKER` | `CRITICAL` | Mapped to same target priority |
| `CRITICAL` | `CRITICAL` | |
| `MAJOR` | `HIGH` | Mapped to same target priority |
| `MINOR` | `LOW` | Mapped to same target priority |
| `TRIVIAL` | `TRIVIAL` | |

## Entity Relationships

### Test Case to Test Steps
- In Zephyr: Steps are nested within test cases
- In qTest: Steps are nested within test cases
- Mapping: Direct hierarchical mapping, preserving order

### Test Cycle to Test Executions
- In Zephyr: Executions belong to cycles
- In qTest: Test runs belong to test cycles 
- Mapping: Create test runs in qTest corresponding to executions in Zephyr

### Test Executions to Test Step Results
- In Zephyr: Step results belong to executions
- In qTest: Step logs belong to test logs
- Mapping: Create step logs in qTest corresponding to step results in Zephyr

## Handling Special Cases

### Missing Fields
- If required fields are missing in Zephyr, use default values in qTest
- Log warnings for all default values used

### Data Type Mismatches
- Implement type conversion for common mismatches
- If conversion fails, use string representation and log warning

### Entity References
- Maintain a mapping table of Zephyr IDs to qTest IDs
- Use the mapping table to preserve relationships

### Binary Attachments
- Download attachments from Zephyr and upload to qTest
- Verify file integrity with checksums
- Handle large files with chunked uploads

### User Mappings
- Create mapping between Zephyr users and qTest users
- If user doesn't exist in qTest, use default user and log warning

## Validation Rules

### Pre-transformation Validation
- Ensure all required Zephyr fields are present
- Validate data types match expected formats
- Check that referenced entities exist

### Post-transformation Validation
- Ensure all required qTest fields are present
- Validate relationships are preserved
- Check custom field mappings are consistent

## Migration Considerations

### Order of Migration
1. Create project structure and modules
2. Migrate test cases with steps and attachments
3. Create test cycles
4. Migrate test executions with results and attachments

### Incremental Migration
- Support incremental migration based on modification date
- Implement conflict resolution for updated entities

### Rollback Capability
- Maintain mapping tables for rollback
- Implement deletion of created entities if migration fails

## Mapping Extension
The mapping engine should be extensible to support:
- Custom field mapping definitions
- Entity relationship customizations
- Organization-specific naming conventions
- Integration with external systems (JIRA, etc.)

---
*Copyright (c) 2025 Eric C. Mumford (@heymumford) - Licensed under [MIT License](../../LICENSE)*